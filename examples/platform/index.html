<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Platform â€“ contextmenu.js</title>
  <link rel="stylesheet" href="../../src/style.css">
  <style>
    body { font-family: system-ui, sans-serif; padding: 2rem; max-width: 48rem; }
    h1 { font-size: 1.25rem; margin-bottom: 0.5rem; }
    p { color: #666; margin: 0 0 1.5rem 0; font-size: 14px; }
    .controls { margin-bottom: 1.5rem; display: flex; flex-wrap: wrap; align-items: center; gap: 0.75rem; }
    .controls label { font-weight: 500; }
    .controls select { padding: 0.4rem 0.75rem; font-size: 14px; border-radius: 6px; min-width: 140px; }
    .target { padding: 2rem; background: #f0f0f0; border-radius: 8px; margin-bottom: 1rem; }
    .target:hover { background: #eee; border-color: #999; }
  </style>
</head>
<body>
  <h1>Platform (shortcut display)</h1>
  <p>Choose which OS the menu should adapt to. Right-click the area below to see shortcuts rendered for that platform.</p>
  <div class="controls">
    <label for="platform-select">Platform:</label>
    <select id="platform-select">
      <option value="auto">Auto (detect)</option>
      <option value="mac">Mac</option>
      <option value="win">Windows</option>
    </select>
    <label for="use-icons">
      <input type="checkbox" id="use-icons">
      Use shortcut icons (SVG) when Windows
    </label>
  </div>
  <div class="target" id="target">
    Right-click here to open the context menu.
  </div>
  <script type="module">
    import { createContextMenu } from "../../src/index.ts";

    const WIN_CTRL_SVG = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="1em" height="1em"><path d="M6 5h2v14H6V5zm10 0h2v14h-2V5z"/></svg>';
    const WIN_SHIFT_SVG = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="1em" height="1em"><path d="M12 2L4 14h5v8h6v-8h5L12 2z"/></svg>';
    const WIN_ENTER_SVG = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="1em" height="1em"><path d="M19 7v4H5.83l3.58-3.59L8 6l-6 6 6 6 1.41-1.41L5.83 13H21V7h-2z"/></svg>';

    function getPlatform() {
      const v = document.getElementById("platform-select").value;
      return v === "auto" ? undefined : v;
    }

    function getShortcutIcons() {
      if (!document.getElementById("use-icons").checked) return undefined;
      return {
        ctrl: WIN_CTRL_SVG,
        shift: WIN_SHIFT_SVG,
        enter: WIN_ENTER_SVG,
      };
    }

    function createMenu() {
      return createContextMenu({
        menu: [
          { label: "Copy", shortcut: "Ctrl+C", onClick: () => console.log("Copy") },
          { label: "Paste", shortcut: "Ctrl+V", onClick: () => console.log("Paste") },
          { label: "Save", shortcut: "Ctrl+S", onClick: () => console.log("Save") },
          { type: "separator" },
          { label: "New (Shift+Enter)", shortcut: "Ctrl+Shift+Enter", onClick: () => console.log("New") },
          { label: "Switch tab", shortcut: "Alt+Tab", onClick: () => console.log("Switch tab") },
          { type: "separator" },
          {
            type: "submenu",
            label: "More",
            shortcut: "Win+E",
            children: [
              { label: "Rename", shortcut: "F2", onClick: () => console.log("Rename") },
              { label: "Delete", shortcut: "Delete", onClick: () => console.log("Delete") },
            ],
          },
        ],
        platform: getPlatform(),
        shortcutIcons: getShortcutIcons(),
        submenuArrow: true,
        theme: { tokens: { radius: "8px", shadow: "0 4px 12px rgba(0,0,0,0.12)" } },
        position: { padding: 8 },
      });
    }

    let menu = createMenu();
    const target = document.getElementById("target");
    menu.bind(target);

    function rebuild() {
      menu.destroy();
      menu = createMenu();
      menu.bind(target);
    }

    document.getElementById("platform-select").addEventListener("change", rebuild);
    document.getElementById("use-icons").addEventListener("change", rebuild);
  </script>
</body>
</html>
